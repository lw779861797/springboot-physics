<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="/static/vendors/dataTable/dataTables.min.css" type="text/css">

    <!-- Javascript -->
    <script src="/static/vendors/dataTable/jquery.dataTables.min.js"></script>

    <!-- Bootstrap 4 and responsive compatibility -->
    <script src="/static/vendors/dataTable/dataTables.bootstrap4.min.js"></script>
    <script src="/static/vendors/dataTable/dataTables.responsive.min.js"></script>
    <!-- Favicon -->
    <!--<link rel="shortcut icon" href="/static/assets/media/image/favicon.png"/>-->
    <link rel="stylesheet" href="/static/vendors/bundle.css" type="text/css">

    <link rel="stylesheet" href="/static/vendors/prism/prism.css" type="text/css">
    <link rel="stylesheet" href="/static/assets/css/app.min.css" type="text/css">
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
</head>
<body>
<div class="navigation">

    <!-- begin::logo -->
    <div id="logo">

    </div>
    <div class="navigation-menu-body">
        <ul>
            <li class="navigation-divider">导航栏</li>
            <li class="open">
                <a href="/">
                    <!--<i class="nav-link-icon" data-feather="check-circle"></i>-->
                    <span>首页</span>
                </a>

            </li>
            <li>
                <a href="/login">
                    <!--<i class="nav-link-icon" data-feather="message-circle"></i>-->
                    <span>实验预约</span>
                    <!--<span class="badge badge-danger">2</span>-->
                </a>
            </li>
            <li>
                <a href="/notgo">
                    <!--<i class="nav-link-icon" data-feather="mail"></i>-->
                    <span>成绩评定</span>
                    <!--<span class="badge badge-success">2</span>-->
                </a>
            </li>
            <li>
                <a href="/notgo">
                    <!--<i class="nav-link-icon" data-feather="check-circle"></i>-->
                    <span>课表查询</span>
                    <!--<span class="badge badge-warning">2</span>-->
                </a>
            </li>
            <li>
                <a href="/queryLessonTeacher">
                    <!--<i class="nav-link-icon" data-feather="file"></i>-->
                    <span>任课教师</span>
                </a>
            </li>
            <li>
                <a href="/queryAnswers">
                    <!--<i class="nav-link-icon" data-feather="calendar"></i>-->
                    <span>查看留言板</span>
                </a>
            </li>
            <li>
                <a href="/addAnswerLogin">
                    <!--<i class="nav-link-icon" data-feather="calendar"></i>-->
                    <span>发布留言</span>
                </a>
            </li>
            <li>
                <a href="/queryComplaint">
                    <!--<i class="nav-link-icon" data-feather="calendar"></i>-->
                    <span>查看投诉信箱</span>
                </a>
            </li>
            <li>
                <a href="/addComplaintLoing">
                    <!--<i class="nav-link-icon" data-feather="calendar"></i>-->
                    <span>发布投诉</span>
                </a>
            </li>
            <li>
                <a href="/queryGoodsLogin">
                    <!--<i class="nav-link-icon" data-feather="calendar"></i>-->
                    <span>查看失物招领</span>
                </a>
            </li>
            <li>
                <a href="/addGoodsLogin">
                    <!--<i class="nav-link-icon" data-feather="calendar"></i>-->
                    <span>发布失物招领</span>
                </a>
            </li>
            <li>
                <a href="/notgo">
                    <!--<i class="nav-link-icon" data-feather="check-circle"></i>-->
                    <span>素材下载</span>
                </a>
            </li>
            <li>
                <a href="/notgo">
                    <!--<i class="nav-link-icon" data-feather="check-circle"></i>-->
                    <span>实验室简介</span>
                </a>
            </li>
            <li>
                <a href="/notgo">
                    <!--<i class="nav-link-icon" data-feather="check-circle"></i>-->
                    <span>选课名单查询</span>
                </a>
            </li>
            <li>
                <a href="/notgo">
                    <!--<i class="nav-link-icon" data-feather="check-circle"></i>-->
                    <span style="color: coral">教师通道</span>
                </a>
            </li>
        </ul>
    </div>
    <!-- end::navigation menu -->
</div>
<!-- end::navigation -->

<!-- begin::main -->
<div id="main">



    <!-- begin::main-content -->
    <main class="main-content">

        <div class="container">
            <h2 style="font-size: 17px">这周是第&nbsp;&nbsp;<b th:text="${session.week}" style="color: red;">1</b>&nbsp;&nbsp;周</h2>
            <!-- begin::page-header -->
            <div class="page-header">
                <h4>预约实验</h4>
            </div>
            <!-- end::page-header -->

            <div class="row" style="min-height: 590px;">
                <div class="col-md-12">

                    <div class="card">
                        <div class="card-body">
                            <ul class="nav nav-tabs mb-3" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab"
                                       aria-controls="home" aria-selected="true">实验预约（空位查询）</a>
                                </li>
                            </ul>
                            <div class="tab-content">
                                <!--实验预约与空位查询-->
                                <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">


                                    <table id="myTable" class="table table-striped table-bordered">
                                        <thead>
                                        <tr style="text-align: center">
                                            <th>序号</th>
                                            <th>实验题目</th>
                                            <th>房间号</th>
                                            <th>周次</th>
                                            <th>备注</th>
                                            <th>类型</th>
                                            <th>选择</th>
                                            <th>预约</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr th:each="lessonVo,inStat : ${session.lessonVos}" style="text-align: center">
                                            <td th:text="${lessonVo.id}"></td>
                                            <td th:text="${lessonVo.name}"></td>
                                            <td th:text="${lessonVo.address}"></td>
                                            <td th:text="${lessonVo.time}"></td>
                                            <td th:text="${lessonVo.remarks}"></td>
                                            <th th:text="${lessonVo.type}"></th>
                                            <td>
                                                <select th:id="'select'+${lessonVo.id}" th:if="${lessonVo.weeklys.size()} ne 0">
                                                    <option th:each="weekly : ${lessonVo.weeklys}" >
                                                        <b th:value="${weekly}" th:text="${weekly}"></b>
                                                    </option>
                                                </select>
                                            </td>
                                            <td>
                                                <button th:if="${lessonVo.weeklys.size()} ne 0" th:value="${lessonVo.id}" type="button" class="btn btn-success" onclick="appointment(this)">预约</button>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <!--<button type="button" class="btn btn-secondary"></button>-->
                                <a href="/queryStudentCourse"><button type="button" class="btn btn-light">查询预约</button></a>
                                <a href="/update_pass_word"><button type="button" class="btn btn-light">修改密码</button></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

</div>
<!--注释掉下面三个可解决错位问题-->
<!--&lt;!&ndash;<script src="/static/vendors/bundle.js"></script>&ndash;&gt;-->
<!--&lt;!&ndash;<script src="/static/vendors/prism/prism.js"></script>&ndash;&gt;-->
<!--<script src="/static/assets/js/app.min.js"></script>-->
<script>
    function appointment(o) {
        var id=o.value;
        var weekly=$("#select"+id).find("option:selected") .val();
        $.post(
            "/appointment",
            {"lesson_id":id,"weekly":weekly},
            function (result) {
                if(result == "1"){
                    alert("预约成功");
                }else if(result == "0"){
                    alert("课程已满");
                }else if (result == "3"){
                    alert("已经选过该实验");
                } else {
                    alert("系统繁忙");
                }
            }
        )
    }
</script>
</body>
</html>